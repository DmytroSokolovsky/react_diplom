"use strict";(self.webpackChunkui=self.webpackChunkui||[]).push([[277],{931:(e,t,o)=>{o.d(t,{K:()=>r});const r=o(213).A.create({baseURL:"https://api-diplom-eupy.onrender.com/api/"})},277:(e,t,o)=>{o.r(t),o.d(t,{default:()=>v});var r=o(43),l=o(795),a=o(950);const d={modal:"Modal_modal__GYX1Z",modal__container:"Modal_modal__container__c+3RE",modal__title:"Modal_modal__title__+Y9C8",modal__buttons:"Modal_modal__buttons__9UWYR",modal__button:"Modal_modal__button__1NCkg"};var s=o(579);const n=e=>{let{onConfirm:t,onCancel:o,record:l}=e;const n=(0,r.useRef)(null),c=(0,r.useRef)(null),i=(0,r.useRef)(null),_=(0,r.useCallback)((e=>{if("Escape"===e.key&&o(),"Tab"===e.key){const t=n.current.querySelectorAll("button"),o=t[0],r=t[t.length-1];e.shiftKey?document.activeElement===o&&(e.preventDefault(),r.focus()):document.activeElement===r&&(e.preventDefault(),o.focus())}}),[o]);return(0,r.useEffect)((()=>(window.addEventListener("keydown",_),c.current.focus(),()=>{window.removeEventListener("keydown",_)})),[_]),(0,a.createPortal)((0,s.jsx)("div",{className:d.modal,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title","aria-describedby":"modal-description",children:(0,s.jsx)("div",{className:d.modal__container,ref:n,children:(0,s.jsxs)("div",{className:d.modal__body,children:[(0,s.jsxs)("div",{id:"modal-title",className:d.modal__title,children:["\u0412\u0438 \u0434\u0456\u0439\u0441\u043d\u043e \u0431\u0430\u0436\u0430\u0454\u0442\u0435 \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441 \u0434\u043e \u043b\u0456\u043a\u0430\u0440\u044f ",null===l||void 0===l?void 0:l.doctor," \u043d\u0430 ",null===l||void 0===l?void 0:l.date," \u043e ",null===l||void 0===l?void 0:l.time,"?"]}),(0,s.jsxs)("div",{id:"modal-description",className:d.modal__buttons,children:[(0,s.jsx)("button",{className:d.modal__button,onClick:t,"aria-label":"\u041f\u0456\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u0437\u0430\u043f\u0438\u0441\u0443",ref:c,children:"\u0422\u0430\u043a"}),(0,s.jsx)("button",{className:d.modal__button,onClick:o,"aria-label":"\u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u044f \u0437\u0430\u043f\u0438\u0441\u0443",ref:i,children:"\u041d\u0456"})]})]})})}),document.body)},c="RecordItem_record__1bx+W",i="RecordItem_record__delete__tVIVl";const _=function(e){let{record:t,onDelete:o}=e;return(0,s.jsxs)("div",{className:c,role:"article","aria-labelledby":`record-${t._id}`,children:[(0,s.jsxs)("p",{tabIndex:0,children:[(0,s.jsx)("span",{children:"\u041b\u0456\u043a\u0430\u0440:"})," ",t.doctor]}),(0,s.jsxs)("p",{tabIndex:0,children:[(0,s.jsx)("span",{children:"\u0414\u0430\u0442\u0430:"})," ",t.date]}),(0,s.jsxs)("p",{tabIndex:0,children:[(0,s.jsx)("span",{children:"\u0427\u0430\u0441:"})," ",t.time]}),(0,s.jsx)("button",{className:i,onClick:()=>o(t),"aria-label":`\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441 \u0434\u043e \u043b\u0456\u043a\u0430\u0440\u044f ${t.doctor} \u043d\u0430 ${t.date} \u043e ${t.time}`,children:"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441"})]})},u={records:"RecordList_records__Cd2hk",records__title:"RecordList_records__title__4niOz",records__no:"RecordList_records__no__hZbML"};const m=function(e){let{records:t,onDelete:o,errorMessage:r}=e;return r?null:(0,s.jsxs)("div",{className:u.records,role:"region","aria-labelledby":"records-title",children:[(0,s.jsx)("h2",{tabIndex:0,id:"records-title",className:u.records__title,children:"\u0412\u0430\u0448\u0456 \u0437\u0430\u043f\u0438\u0441\u0438"}),(0,s.jsx)("div",{className:u.records__list,role:"list",children:t.length>0?t.map((e=>(0,s.jsx)("div",{role:"listitem",children:(0,s.jsx)(_,{record:e,onDelete:o})},e._id))):(0,s.jsx)("p",{className:u.records__no,role:"alert",children:"\u0417\u0430\u043f\u0438\u0441\u0438 \u0432\u0456\u0434\u0441\u0443\u0442\u043d\u0456"})})]})};var b=o(931);const h={get:e=>b.K.get(`records/${e}`).then((e=>e.data)),delete:e=>b.K.delete(`records/${e}`).then((e=>e.data))};var f=o(939),x=o(632);const v=function(){const{tg:e,onReady:t,sendDataToTelegram:o}=(0,f.j)(),[a,d]=(0,r.useState)([]),[c,i]=(0,r.useState)(!1),[_,u]=(0,r.useState)(null),[b,v]=(0,r.useState)(""),[j,p]=(0,r.useState)(""),y=(0,r.useContext)(l.c);(0,r.useEffect)((()=>{y&&async function(e){try{const t=await h.get(e);d(t)}catch(t){v("\u041d\u0435\u043c\u043e\u0436\u043b\u0438\u0432\u043e \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0432\u0430\u0448\u0456 \u0437\u0430\u043f\u0438\u0441\u0438")}}(y)}),[y]),(0,r.useEffect)((()=>{t()}),[t]);const g=(0,r.useCallback)((async t=>{const{_id:r,doctor:l,doctor_id:a,specialization:s,date:n,time:c,patient_name:i,patient_phone_number:_}=t,u={deletedDoctorTelegramId:a,deletedDoctor:l,deletedSpecialization:s,deletedPatientName:i,deletedPatientPhoneNumber:_,deletedRecordDate:n,deletedRecordTime:c};try{await h.delete(r),d((e=>e.filter((e=>e._id!==r)))),e&&o(u),N()}catch(m){p("\u041d\u0435 \u0432\u0434\u0430\u043b\u043e\u0441\u044f \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0437\u0430\u043f\u0438\u0441")}}),[o,e]);(0,r.useEffect)((()=>{if(j){const e=setTimeout((()=>{p("")}),3e3);return()=>clearTimeout(e)}}),[j]);const N=()=>{u(null),i(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m,{records:a,onDelete:e=>{u(e),i(!0)},errorMessage:b}),c&&(0,s.jsx)(n,{onConfirm:()=>{_&&g(_)},onCancel:N,record:_}),b&&(0,s.jsx)(x.y,{errorMessage:b}),j&&(0,s.jsx)(x.y,{errorMessage:j})]})}},632:(e,t,o)=>{o.d(t,{y:()=>i});var r=o(43),l=o(950),a=o(139),d=o.n(a);const s="Toast_toast__RH58L",n="Toast_open__B2TW5";var c=o(579);const i=e=>{let{errorMessage:t}=e;const[o,a]=(0,r.useState)(0);let i=d()(s);return o>0&&(i=d()(s,{[n]:!0})),o>=2.7&&(i=d()(s,{[n]:!1})),(0,r.useEffect)((()=>{const e=setInterval((()=>{a((e=>e+.3))}),300);return()=>{clearInterval(e)}}),[a]),o>=3?null:(0,l.createPortal)((0,c.jsx)("div",{className:i,children:(0,c.jsx)("span",{children:t})}),document.body)}}}]);
//# sourceMappingURL=277.5eee89b6.chunk.js.map